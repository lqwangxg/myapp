# rule-name
name: openMultiMessageDialog
# rule-group
group: showModalDialog

# file suffix of include/exlude
include-file: jsp|html
exclude-file: 

# regex pattern   
pattern: (?P<indent>[ ]*)if\((?P<call>openMultiMessageDialog)\((?P<param>[^{]+)\)\s*\)\s*\{(?P<process>[^}]+?)\}
# export match template
templates: &templates
  name: default
  header: | 
    "--"
    matches.count: ${matches.count}, groups.count: ${groups.count}, groups.keys: ${groups.keys}
    indent | call | param | process
    |--|--|--|
  match : | 
    ${indent} | ${call} | ${param} | ${process}
  
  footer: | 
    "--"
export-template:  
  <<: *templates
  footer: "copyright lqwangxg@gmail.com 2023"

# TODO:
#  #GROUP-LOOP-START#
#    ${group.key}: ${${group.index}}
#  #GROUP-LOOP-END#

# replace match template
replace-template: 
  match : | 
    ${indent}${call}(${param}, "callbackForRetunWindow");
    ${indent}window["callbackForRetunWindow"] = function (res){
    ${indent}  if(res){${process}}
    ${indent}}
  
# match destination range(spos=startIndex, epos=endIndex + endLength) 
# if range_start is empty then spos=0
# if range_end is empty then epos=length(full) or ahead of next range_start
# optional: if groupname is included in pattern, 
#  { match.group.name: match.group.nalue } will be saved in ${match_params_map}
range_start: \nfunction\s+(?P<function>\w+)\(form\)\s*\{.+?\n\}
range_end:
